<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Newly Optimized RF24Network Layer: Network Layer for RF24 Radios</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Newly Optimized RF24Network Layer
   &#160;<span id="projectnumber">1.0.16</span>
   </div>
   <div id="projectbrief">2020 - Optimized RF24 Network Layer for NRF24L01 radios</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Network Layer for RF24 Radios </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_docs_main_page"></a> This class implements an <a href="http://en.wikipedia.org/wiki/Network_layer">OSI Network Layer</a> using nRF24L01(+) radios driven by the newly optimized <a href="http://nRF24.github.com/RF24/">RF24 library fork</a>.</p>
<dl class="section see"><dt>See also</dt><dd><a href="http://nRF24.github.io/RF24/">RF24 Library docs</a> for general RF24 configuration and setup.<ul>
<li><a href="http://nRF24.github.io/RF24/md_docs_linux_install.html">Linux Installation</a> and <a href="http://nRF24.github.io/RF24/md_docs_rpi_general.html">General Linux/RPi configuration and setup</a> documentation</li>
</ul>
</dd></dl>
<h1><a class="anchor" id="autotoc_md7"></a>
Purpose/Goal</h1>
<p>Original: Create an alternative to ZigBee radios for Arduino communication.</p>
<p>New: Enhance the current functionality for maximum efficiency, reliability, and speed</p>
<p>Xbees are excellent little radios, backed up by a mature and robust standard protocol stack. They are also expensive.</p>
<p>For many Arduino uses, they seem like overkill. So I am working to improve the current standard for nRF24L01 radios. The best RF24 modules are available for less than $6 from many sources. With the <a class="el" href="classRF24Network.html">RF24Network</a> layer, I hope to cover many common communication scenarios.</p>
<p>Please see <a href="https://tmrh20.blogspot.com/2019/05/comparative-performance-analysis.html">TMRh20's blog post</a> for a comparison against the ZigBee protocols</p>
<h1><a class="anchor" id="autotoc_md8"></a>
News</h1>
<p>Please see the recent changes listed in <a href="https://github.com/nRF24/RF24Network/releases">the github releases page</a></p>
<h1><a class="anchor" id="autotoc_md9"></a>
Features</h1>
<h2><a class="anchor" id="autotoc_md10"></a>
The layer provides</h2>
<ul>
<li>Network ACKs: Efficient acknowledgement of network-wide transmissions, via dynamic radio acks and network protocol acks.</li>
<li>Updated addressing standard for optimal radio transmission.</li>
<li>Extended timeouts and staggered timeout intervals. The new txTimeout variable allows fully automated extended timeout periods via auto-retry/auto-reUse of payloads.</li>
<li>Optimization to the core library provides improvements to reliability, speed and efficiency. See <a href="https://nRF24.github.io/RF24">RF24 library documentation</a> for more info.</li>
<li>Built in sleep mode using interrupts. (Still under development &ndash; enable via <a class="el" href="RF24Network__config_8h.html">RF24Network_config.h</a>)</li>
<li>Host Addressing. Each node has a logical address on the local network.</li>
<li>Message Forwarding. Messages can be sent from one node to any other, and this layer will get them there no matter how many hops it takes.</li>
<li>Ad-hoc Joining. A node can join a network without any changes to any existing nodes.</li>
</ul>
<h2><a class="anchor" id="autotoc_md11"></a>
The layer does not provide</h2>
<ul>
<li>Dynamic address assignment (See <a href="https://github.com/nRF24/RF24Mesh">RF24Mesh</a>)</li>
<li>Layer 4 protocols (TCP/IP - See <a href="https://github.com/nRF24/RF24Ethernet">RF24Ethernet</a> and <a href="https://github.com/nRF24/RF24Gateway">RF24Gateway</a>)</li>
</ul>
<h1><a class="anchor" id="autotoc_md12"></a>
How to learn more</h1>
<ul>
<li><a href="classRF24Network.html">RF24Network Class Documentation</a></li>
<li><a href="md_docs_advanced_config.html">Advanced Configuration Options</a></li>
<li><a href="md_docs_addressing.html">Addressing format</a></li>
<li><a href="md_docs_tuning.html">Topology and Overview</a></li>
<li><a href="https://github.com/TMRh20/RF24Network/archive/Development.zip">Download Current Development Package</a></li>
<li><a href="examples.html">Examples Page</a>. Start with <code>helloworld_*</code> examples.</li>
</ul>
<h2><a class="anchor" id="autotoc_md13"></a>
Additional Information &amp; Add-ons</h2>
<ul>
<li><a href="https://github.com/nRF24/RF24Mesh">RF24Mesh: Dynamic Mesh Layer for RF24Network Dev</a></li>
<li><a href="https://github.com/nRF24/RF24Ethernet">RF24Ethernet: TCP/IP over RF24Network</a></li>
<li><a href="http://tmrh20.blogspot.com/2014/03/high-speed-data-transfers-and-wireless.html">TMRh20's Blog: RF24 Optimization Overview</a></li>
<li><a href="http://tmrh20.blogspot.com/2014/03/arduino-radiointercomwireless-audio.html">TMRh20's Blog: RF24 Wireless Audio</a></li>
<li><a href="http://maniacbug.github.com/RF24/">RF24: Original Author</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md14"></a>
Topology for Mesh Networks using nRF24L01(+)</h1>
<p>This network layer takes advantage of the fundamental capability of the nRF24L01(+) radio to listen actively to up to 6 other radios at once. The network is arranged in a <a href="http://en.wikipedia.org/wiki/Network_Topology#Tree">Tree Topology</a>, where one node is the base, and all other nodes are children either of that node, or of another. Unlike a true mesh network, multiple nodes are not connected together, so there is only one path to any given node.</p>
<h1><a class="anchor" id="autotoc_md15"></a>
Octal Addressing and Topology</h1>
<p>Each node must be assigned an 15-bit address by the administrator. This address exactly describes the position of the node within the tree. The address is an octal number. Each digit in the address represents a position in the tree further from the base.</p>
<ul>
<li>Node 00 is the base node.</li>
<li>Nodes 01-05 are nodes whose parent is the base.</li>
<li>Node 021 is the second child of node 01.</li>
<li>Node 0321 is the third child of node 021, an so on.</li>
<li>The largest node address is 05555, so up to 781 nodes are allowed on a single channel. An example topology is shown below, with 5 nodes in direct communication with the master node, and multiple leaf nodes spread out at a distance, using intermediate nodes to reach other nodes.</li>
</ul>
<p>![ </p><div class="image">
<object type="image/svg+xml" data="example_tree.svg" style="pointer-events: none;"></object>
</div>
<p> ](<a href="https://github.com/nRF24/RF24Network/blob/CMake-4-Linux/images/example_tree.svg">https://github.com/nRF24/RF24Network/blob/CMake-4-Linux/images/example_tree.svg</a>)</p>
<h1><a class="anchor" id="autotoc_md16"></a>
How routing is handled</h1>
<p>When sending a message using <a class="el" href="classRF24Network.html#ac8e9571bb3d2c20d00955b8f5c15b541">RF24Network::write()</a>, you fill in the header with the logical node address. The network layer figures out the right path to find that node, and sends it through the system until it gets to the right place. This works even if the two nodes are far separated, as it will send the message down to the base node, and then back out to the final destination.</p>
<p>All of this work is handled by the <a class="el" href="classRF24Network.html#ad59983f89b09d17d7d9b0581f658a41c">RF24Network::update()</a> method, so be sure to call it regularly or your network will miss packets.</p>
<h1><a class="anchor" id="autotoc_md17"></a>
Starting up a node</h1>
<p>When a node starts up, it only has to contact its parent to establish communication. No direct connection to the Base node is needed. This is useful in situations where relay nodes are being used to bridge the distance to the base, so leaf nodes are out of range of the base.</p>
<h1><a class="anchor" id="autotoc_md18"></a>
Directionality</h1>
<p>By default all nodes are always listening, so messages will quickly reach their destination.</p>
<p>You may choose to sleep any nodes on the network if using interrupts. This is useful in a case where the nodes are operating on batteries and need to sleep. This greatly decreases the power requirements for a sensor network. The leaf nodes can sleep most of the time, and wake every few minutes to send in a reading. Routing nodes can be triggered to wake up whenever a payload is received See <a class="el" href="classRF24Network.html#acc3e7809ffc7ff48579811d2e063142a">RF24Network::sleepNode()</a> in the class documentation, and <a class="el" href="RF24Network__config_8h.html">RF24Network_config.h</a> to enable sleep mode. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Nov 28 2021 12:48:49 for Newly Optimized RF24Network Layer by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
